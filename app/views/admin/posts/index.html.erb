<h1>投稿管理</h1>

<% if params[:q].present? %>
  <p class="text-muted mt-2">
    検索ワード: <strong><%= h params[:q] %></strong>
    （<%= @posts.size %>件）
  </p>
<% end %>

<%= paginate @posts, params: request.query_parameters %>

<table class="table table-striped">
  <thead>
    <tr>
      <th>ID</th>
      <th>投稿者</th>
      <th>本文</th>
      <th>投稿日</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <% @posts.each do |post| %>
      <tr>
        <td><%= post.id %></td>
        <td>
          <% if post.respond_to?(:user) && post.user.present? %>
            <%= link_to post.user.name, admin_user_path(post.user) %>
          <% else %>
            (不明)
          <% end %>
        </td>
        <td>
          <%= truncate(post.body, length: 30) %>
        </td>
        <td><%= post.created_at.strftime("%Y/%m/%d %H:%M") %></td>
        <td>
          <%= link_to "詳細", admin_post_path(post), class: "btn btn-outline-secondary btn-sm" %>
          <%= link_to "編集", edit_admin_post_path(post), class: "btn btn-outline-primary btn-sm" %>
          <%= link_to "削除", admin_post_path(post),
                        method: :delete,
                        data: { confirm: "本当に削除しますか？" },
                        class: "btn btn-danger btn-sm" %>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>

<%= link_to "← 管理者ホームに戻る", admin_root_path, class: "btn btn-secondary" %>
      