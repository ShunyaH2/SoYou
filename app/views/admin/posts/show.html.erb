<h1>投稿詳細</h1>

<table class="table">
  <tr>
    <th>ID</th>
    <td><%= @post.id %></td>
  </tr>
  <tr>
    <th>投稿者</th>
    <td>
      <% if @post.user.present? %>
        <%= link_to @post.user.try(:name) || "ユーザー##{@post.user.id}", admin_user_path(@post.user) %>
      <% else %>
        (不明)
      <% end %>
    </td>
  </tr>
  <tr>
    <th>本文</th>
    <td style="white-space: pre-wrap;"><%= @post.body %></td>
  </tr>
  <tr>
    <th>タグ</th>
    <td>
      <% if @post.tags.any? %>
        <% @post.tags.each do |tag| %>
          <span class="badge badge-info mr-1"><%= tag.name %></span>
        <% end %>
      <% else %>
        <span class="text-muted">なし</span>
      <% end %>
    </td>
  </tr>
  <tr>
    <th>投稿日</th>
    <td><%= @post.created_at.strftime("%Y/%m/%d %H:%M") %></td>
  </tr>
  <tr>
    <th>更新日</th>
    <td><%= @post.updated_at.strftime("%Y/%m/%d %H:%M") %></td>
  </tr>
</table>

<h2 class="mt-4">コメント</h2>

<% if @comments.present? %>
  <ul class="list-group mb-3">
    <% @comments.each do |comment| %>
      <li class="list-group-item">
        <div class="mb-1"><%= simple_format(comment.body) %></div>
        <small class="text-muted">
          <%= (comment.user&.name.presence || comment.user&.email || "退会ユーザー") %> /
          <%= comment.created_at.strftime("%Y/%m/%d %H:%M") %>
        </small>
      </li>
    <% end %>
  </ul>
<% else %>
  <p class="text-muted">この投稿にはまだコメントがありません。</p>
<% end %>

<div class="d-flex gap-2">
  <%= link_to "編集", edit_admin_post_path(@post), class: "btn btn-primary" %>
  <%= link_to "削除", admin_post_path(@post), method: :delete,
        data: { confirm: "本当に削除しますか？" }, class: "btn btn-danger" %>
  <%= link_to "← 投稿管理へ戻る", admin_posts_path, class: "btn btn-secondary" %>
</div>


